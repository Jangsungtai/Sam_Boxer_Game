# 일반 모드 vs 테스트 모드 차이점

## 설정 위치
`config/rules.json`의 `test_mode` 값을 `true` 또는 `false`로 설정

---

## 주요 차이점

### 1. **펀치 감지 (Pose Tracker)**

#### 테스트 모드
- ✅ **속도 조건 무시**: 손의 속도(`vL`, `vR`)를 체크하지 않음
- ✅ **각도 조건 무시**: 손의 각도(`angL`, `angR`)를 체크하지 않음
- ✅ **구역과 쿨타임만 체크**: 손이 히트존 구역에 있고, 쿨타임(0.25초)이 지났으면 펀치 인식

#### 일반 모드
- ✅ **모든 조건 체크**: 속도(`action_v_thresh: 1.0`), 각도(`action_ang_thresh: 160`), 구역, 쿨타임 모두 체크
- 더 엄격한 펀치 인식 (실제 펀치 동작만 감지)

---

### 2. **판정 로직 (Game Scene)**

#### 테스트 모드 - JAB 노트
- ✅ **타이밍 판정 무시**: 시간 차이(`dt`)를 체크하지 않음
- ✅ **공간 판정만 체크**: 손이 히트존 안에 있는지만 확인
- ✅ **노트 도달 확인**: 노트가 히트존에 실제로 도달했는지 확인 (미리 판정하지 않음)
- ✅ **판정 결과**:
  - 노트가 히트존에 도달 + 손이 히트존 안 → **PERFECT**
  - 노트가 히트존에 도달 + 손이 히트존 밖 → **"area"** (MISS)
  - 노트가 히트존에 도달하지 않음 → 판정하지 않음 (무시)

#### 일반 모드 - JAB 노트
- ✅ **공간 + 타이밍 모두 체크**
- ✅ **판정 결과**:
  - 공간 O + 타이밍 O → **PERFECT/GREAT/GOOD** (타이밍에 따라)
  - 공간 O + 타이밍 X → **"timing"** (MISS)
  - 공간 X + 타이밍 O → **"area"** (MISS)
  - 공간 X + 타이밍 X → **"area/timing"** (MISS)

#### 테스트 모드 - DUCK 노트
- ✅ **타이밍 무시**: 무조건 **PERFECT**

#### 일반 모드 - DUCK 노트
- ✅ **정상 판정 로직**: 타이밍에 따라 PERFECT/GREAT/GOOD/MISS 판정

---

### 3. **시각적 디버깅 기능**

#### 테스트 모드에만 표시되는 기능:

1. **노트 외곽선 색상 변경**
   - 노트가 판정 유효 시간(`good` 타이밍) 내에 있으면 → 외곽선이 **빨간색**으로 변경
   - "현재 칠 수 있는 노트"를 시각적으로 표시

2. **이벤트 히스토리 시각화**
   - 왼쪽 하단에 최근 30개 이벤트를 **점**으로 표시
   - 색상:
     - JAB_L: 주황색
     - JAB_R: 파란색
     - DUCK: 회색
   - 시간에 따라 투명도 조절 (최근일수록 밝게)

3. **디버그 정보 출력**
   - 콘솔에 판정 정보 출력: `[DEBUG] JAB_L: dt=0.091s, judge=GOOD, is_in_time=True, is_in_space=True`
   - 판정 로그에 `dt` 정보 포함: `"PERFECT (+0.05s)"` 형식

4. **실시간 디버그 정보**
   - 히트존 위에 다음 노트의 남은 시간과 공간 거리 표시:
     - `Time: ±X.XXXs` (다음 노트까지 남은 시간)
     - `Dist: XXX.Xpx` (다음 노트까지 공간 거리)

---

### 4. **공통 기능**

다음 기능은 **일반 모드와 테스트 모드 모두**에서 동작합니다:

- ✅ 점수 및 콤보 시스템
- ✅ 판정 통계 표시 (PERFECT, GREAT, GOOD, MISS)
- ✅ 히트존 시각화
- ✅ 랜드마크 시각화 (주먹 중심 등)
- ✅ 노트에 숫자 라벨 표시 (1, 2, 3, 4)

---

## 요약

| 기능 | 테스트 모드 | 일반 모드 |
|------|------------|----------|
| **펀치 감지** | 구역+쿨타임만 | 속도+각도+구역+쿨타임 |
| **JAB 판정** | 공간만 체크 (타이밍 무시) | 공간+타이밍 모두 체크 |
| **DUCK 판정** | 무조건 PERFECT | 타이밍에 따라 판정 |
| **노트 외곽선** | 판정 유효 시간 내 빨간색 | 항상 흰색 |
| **이벤트 히스토리** | 왼쪽 하단에 점 표시 | 표시 안 함 |
| **디버그 출력** | 콘솔에 상세 정보 출력 | 출력 안 함 |
| **판정 로그 dt** | dt 정보 포함 | dt 정보 없음 |
| **실시간 디버그** | 히트존 위에 시간/거리 표시 | 표시 안 함 |

---

## 사용 목적

### 테스트 모드
- ✅ **공간 판정 디버깅**: 손이 히트존에 올바르게 들어가는지 확인
- ✅ **노트 타이밍 디버깅**: 노트가 언제 히트존에 도달하는지 확인
- ✅ **이벤트 발생 확인**: 펀치/덕 이벤트가 올바르게 발생하는지 확인
- ✅ **시각적 피드백**: 노트가 판정 가능한 시점을 시각적으로 표시

### 일반 모드
- ✅ **실제 게임플레이**: 완전한 판정 시스템 (공간 + 타이밍)
- ✅ **정확한 펀치 감지**: 실제 펀치 동작만 감지
- ✅ **점수 및 콤보**: 정확한 타이밍에 따른 점수 계산

